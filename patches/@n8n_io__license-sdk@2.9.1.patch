diff --git a/dist/LicenseManager.js b/dist/LicenseManager.js
index 9e5d1e9de..111b1bf60 100644
--- a/dist/LicenseManager.js
+++ b/dist/LicenseManager.js
@@ -1,31 +1,24 @@
 "use strict";var L=Object.create;var g=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var S=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var P=(s,e)=>{for(var t in e)g(s,t,{get:e[t],enumerable:!0})},E=(s,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of N(e))!O.call(s,i)&&i!==t&&g(s,i,{get:()=>e[i],enumerable:!(n=M(e,i))||n.enumerable});return s};var T=(s,e,t)=>(t=s!=null?L(S(s)):{},E(e||!s||!s.__esModule?g(t,"default",{value:s,enumerable:!0}):t,s)),k=s=>E(g({},"__esModule",{value:!0}),s);var K={};P(K,{LicenseManager:()=>C});module.exports=k(K);var p=T(require("crypto-js")),D=require("node-machine-id"),R=T(require("node-rsa")),m=require("crypto");var o=require("undici"),A=require("url");function d(s){let e=process.env[s];return e?new o.ProxyAgent(e):null}var F=d("http_proxy_license_server")||d("http_proxy"),b=d("https_proxy_license_server")||d("https_proxy"),B={...F?{"http:":F}:{},...b?{"https:":b}:{}},z=(process.env.no_proxy??"").split(",").map(s=>s.trim()),U=(0,o.getGlobalDispatcher)();(0,o.setGlobalDispatcher)(new class extends o.Dispatcher{dispatch(s,e){if(s.origin){let{host:t,protocol:n}=typeof s.origin=="string"?new A.URL(s.origin):s.origin;if(!z.some(i=>i.startsWith(".")?t.endsWith(i):t===i)){let i=B[n];i&&i.dispatch(s,e)}}return U.dispatch(s,e)}});async function f(s,e,t={}){let n=new AbortController,i=setTimeout(()=>{n.abort()},t.timeoutInMs??3e4);try{let r=await(0,o.fetch)(s,{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"},signal:n.signal}),a=await r.json();return{status:r.status,data:a}}catch(r){throw new Error("Connection Error",{cause:r})}finally{clearTimeout(i)}}var C=class{constructor(e){this.isInitializationCompleted=!1;this.isShuttingDown=!1;this.config=e,this.config.logger?this.logger=this.config.logger:this.logger={error(){console.log("ERROR:",...arguments)},warn(){console.log("WARN:",...arguments)},info(){console.log("INFO:",...arguments)},debug(){console.log("DEBUG:",...arguments)}},this.x509IssuerCert=new m.X509Certificate(`-----BEGIN CERTIFICATE-----
-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
+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
 -----END CERTIFICATE-----`),this.config.autoRenewEnabled=this.config.autoRenewEnabled??!0,this.config.renewOnInit=this.config.renewOnInit??!1,this.config.offlineMode=this.config.offlineMode??!1,this.config.autoRenewOffset=this.config.autoRenewOffset??60*60*72,this.config.server=this.config.server??"https://license.n8n.io/v1"}log(e,t){this.logger[t](`[license] ${e}`)}isInitialized(){return this.isInitializationCompleted}async initialize(){this.isInitialized()||(this.deviceFingerprint=await this.computeDeviceFingerprint(),this.log(`initializing for deviceFingerprint ${this.deviceFingerprint}`,"debug"),await this.initCert(),this.checkUpcomingEntitlementChangesCron=setInterval(()=>this.setTimerForNextEntitlementChange(),1e3*60*15),this.config.autoRenewEnabled&&(this.config.renewOnInit&&await this.renewalCron({force:!0}),this.renewalIntervalPointer=setInterval(()=>this.renewalCron({force:!1}),1e3*60*15)),this.isInitializationCompleted=!0)}async reload(){this.reset(),await this.initialize()}reset(){this.config.autoRenewEnabled&&clearInterval(this.renewalIntervalPointer),this.checkUpcomingEntitlementChangesCron&&clearInterval(this.checkUpcomingEntitlementChangesCron),this.entitlementChangeTimeoutPointer&&clearTimeout(this.entitlementChangeTimeoutPointer),this.licenseCert=void 0,this.deviceFingerprint=void 0,this.isInitializationCompleted=!1}async computeDeviceFingerprint(){return this.config.deviceFingerprint&&typeof this.config.deviceFingerprint=="function"?await this.config.deviceFingerprint():await(0,D.machineId)()}async activate(e){if(!this.isInitialized())throw new Error("activation failed because SDK was not yet initialized");if(this.isShuttingDown)throw new Error("activation failed because SDK is shutting down");if(this.config.offlineMode)throw new Error("activation failed because SDK is in offline mode");let t={reservationId:e,tenantId:this.config.tenantId,productIdentifier:this.config.productIdentifier,deviceFingerprint:this.deviceFingerprint};this.hasCert()&&(t.consumerId=this.licenseCert.consumerId,t.renewalToken=this.licenseCert.renewalToken);let n;try{n=await f(`${this.config.server}/activate`,t,{timeoutInMs:1e4})}catch(i){throw this.log("license activation failed: "+i.message,"warn"),new Error(i.message)}if(n.status==200){if(!n.data.hasOwnProperty("licenseKey")||!n.data.hasOwnProperty("x509"))throw this.log("unexpected server response","warn"),new Error("unexpected server response");let i=this.stringifyCertContainer({licenseKey:n.data.licenseKey,x509:n.data.x509});await this.config.saveCertStr(i),await this.initCert(),this.log("license successfully activated","info"),(n.data.detachedEntitlementsCount??0>0)&&this.log(`skipped importing ${n.data.detachedEntitlementsCount} floating entitlements which are currently in use elsewhere`,"info")}else{let i=`license activation failed: ${n.data.message??"unknown reason"}`,r=new Error(i);throw n.data.errorId&&(r.errorId=n.data.errorId),this.log(i,"warn"),r}}async renew({detachFloatingEntitlements:e=!1}={}){if(!this.hasCert())throw new Error("renewal failed because current cert is not initialized");if(this.licenseCert.isEphemeral)return;if(this.isTerminated())throw new Error("renewal failed because current cert was terminated");if(this.config.offlineMode)throw new Error("renewal failed because SDK is in offline mode");let t=this.config.collectUsageMetrics?await this.config.collectUsageMetrics():[],n;try{n=await f(`${this.config.server}/renew`,{consumerId:this.licenseCert.consumerId,tenantId:this.config.tenantId,deviceFingerprint:this.deviceFingerprint,productIdentifier:this.config.productIdentifier,renewalToken:this.licenseCert.renewalToken,detachFloatingEntitlements:e,usageMetrics:t},{timeoutInMs:1e4})}catch(r){throw this.log("license renewal failed: "+r.message,"warn"),new Error(r.message)}let i=n.data;if(n.status==200){if(!i.hasOwnProperty("licenseKey")||!i.hasOwnProperty("x509"))throw this.log("license renewal failed: unexpected server response","warn"),new Error("unexpected server response");let r=this.stringifyCertContainer({licenseKey:i.licenseKey,x509:i.x509});await this.config.saveCertStr(r),this.log("license successfully renewed","debug"),(i.detachedEntitlementsCount??0>0)&&this.log(`skipped importing ${i.detachedEntitlementsCount} floating entitlements which are currently in use elsewhere`,"info"),await this.initCert()}else{let r=`license renewal failed: ${i.message??"unknown reason"}`;this.log(r,"warn");let a=new Error(r);throw i.errorId&&(a.errorId=i.errorId,["NOT_FOUND","CONSUMER_TERMINATED"].includes(i.errorId)&&(this.log("license was terminated by the server. Deleting local cert.","warn"),await this.config.saveCertStr(""),await this.initCert())),a}}hasCert(){return!!this.licenseCert}isTerminated(){if(!this.hasCert())throw new Error("Cert is not initialized");let e=new Date;return this.licenseCert.terminatesAt<e}getExpiryDate(){if(!this.hasCert())throw new Error("Cert is not initialized");return this.licenseCert.expiresAt}getTerminationDate(){if(!this.hasCert())throw new Error("Cert is not initialized");return this.licenseCert.terminatesAt}isValid(e=!0){let t=r=>{e&&this.log(r,"debug")};if(!this.hasCert())return t("cert is invalid because it is undefined"),!1;let n=this.licenseCert,i=new Date;return n.expiresAt<i?(t("cert is invalid because it has expired"),!1):n.terminatesAt<i?(t("cert is invalid because it was terminated"),!1):n.createdAt.getTime()-3e5>i.getTime()?(t("cert is invalid because system clock is out of sync"),!1):n.deviceLock&&this.deviceFingerprint!==n.deviceFingerprint?(t("cert is invalid because device fingerprint does not match"),!1):this.config.tenantId!==n.tenantId?(t("cert is invalid because tenant ID does not match"),!1):!0}hasFeatureEnabled(e,t=!0){return!!this.getFeatureValue(e,t)}hasFeatureDefined(e,t=!0){return this.getFeatureValue(e,t)!==void 0}hasQuotaLeft(e,t){let n=this.getFeatureValue(e);if(n===void 0)return!1;if(typeof n!="number")throw new Error(`${e} cannot be used as quota as it is not numeric`);return n===-1?!0:Math.ceil(t)<Math.ceil(n)}getFeatureValue(e,t=!0){if(!this.hasCert()||t&&!this.isValid())return;let n=this.getFeatures();if(!!n.hasOwnProperty(e))return n[e]}updateCurrentFeatures(){if(!this.hasCert())return;let e=new Date;(this.licenseCert.expiresAt<e||this.licenseCert.terminatesAt<e)&&(this.currentFeatures={}),this.currentFeatures=this.licenseCert.entitlements.filter(t=>t.validFrom<=e&&t.validTo>e).sort((t,n)=>t.validFrom.getTime()-n.validFrom.getTime()).reduce((t,n)=>({...t,...n.features,...n.featureOverrides}),{})}getFeatures(){return this.hasCert()?this.currentFeatures??{}:{}}getCurrentEntitlements(){if(!this.hasCert())return[];let e=new Date;return this.licenseCert.entitlements.filter(t=>t.validFrom<=e&&t.validTo>e)}getManagementJwt(){return this.licenseCert?this.licenseCert.managementJwt:""}isRenewalDue(){if(!this.licenseCert||this.licenseCert.isEphemeral)return!1;let e=new Date().getTime(),t=1e3*60*15,n=1e3*60*20,i=this.licenseCert.expiresAt.getTime(),r=this.licenseCert.issuedAt.getTime(),a=this.licenseCert.terminatesAt.getTime(),c=e>i-this.config.autoRenewOffset*1e3&&e<a,l=this.getCurrentEntitlements().find(u=>e>=u.validTo.getTime()-t&&e<=u.validTo.getTime())!==void 0&&r<e-n;return c||l}toString(){var e,t,n,i,r,a,c,l,u,w,v,y,I;return`## CONSUMER CONFIG ##
 tenantId: ${this.config.tenantId??"<n/a>"}
 productIdentifier: ${this.config.productIdentifier??"<n/a>"}
diff --git a/dist/LicenseManager.mjs b/dist/LicenseManager.mjs
index ecadd4bf6..03dd86b54 100644
--- a/dist/LicenseManager.mjs
+++ b/dist/LicenseManager.mjs
@@ -1,31 +1,24 @@
 import v from"crypto-js";import{machineId as N}from"node-machine-id";import S from"node-rsa";import{X509Certificate as y}from"crypto";import{fetch as T,getGlobalDispatcher as F,setGlobalDispatcher as b,Dispatcher as A,ProxyAgent as D}from"undici";import{URL as R}from"url";function u(a){let e=process.env[a];return e?new D(e):null}var C=u("http_proxy_license_server")||u("http_proxy"),w=u("https_proxy_license_server")||u("https_proxy"),x={...C?{"http:":C}:{},...w?{"https:":w}:{}},L=(process.env.no_proxy??"").split(",").map(a=>a.trim()),M=F();b(new class extends A{dispatch(a,e){if(a.origin){let{host:t,protocol:n}=typeof a.origin=="string"?new R(a.origin):a.origin;if(!L.some(i=>i.startsWith(".")?t.endsWith(i):t===i)){let i=x[n];i&&i.dispatch(a,e)}}return M.dispatch(a,e)}});async function g(a,e,t={}){let n=new AbortController,i=setTimeout(()=>{n.abort()},t.timeoutInMs??3e4);try{let r=await T(a,{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"},signal:n.signal}),s=await r.json();return{status:r.status,data:s}}catch(r){throw new Error("Connection Error",{cause:r})}finally{clearTimeout(i)}}var I=class{constructor(e){this.isInitializationCompleted=!1;this.isShuttingDown=!1;this.config=e,this.config.logger?this.logger=this.config.logger:this.logger={error(){console.log("ERROR:",...arguments)},warn(){console.log("WARN:",...arguments)},info(){console.log("INFO:",...arguments)},debug(){console.log("DEBUG:",...arguments)}},this.x509IssuerCert=new y(`-----BEGIN CERTIFICATE-----
-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
+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
 -----END CERTIFICATE-----`),this.config.autoRenewEnabled=this.config.autoRenewEnabled??!0,this.config.renewOnInit=this.config.renewOnInit??!1,this.config.offlineMode=this.config.offlineMode??!1,this.config.autoRenewOffset=this.config.autoRenewOffset??60*60*72,this.config.server=this.config.server??"https://license.n8n.io/v1"}log(e,t){this.logger[t](`[license] ${e}`)}isInitialized(){return this.isInitializationCompleted}async initialize(){this.isInitialized()||(this.deviceFingerprint=await this.computeDeviceFingerprint(),this.log(`initializing for deviceFingerprint ${this.deviceFingerprint}`,"debug"),await this.initCert(),this.checkUpcomingEntitlementChangesCron=setInterval(()=>this.setTimerForNextEntitlementChange(),1e3*60*15),this.config.autoRenewEnabled&&(this.config.renewOnInit&&await this.renewalCron({force:!0}),this.renewalIntervalPointer=setInterval(()=>this.renewalCron({force:!1}),1e3*60*15)),this.isInitializationCompleted=!0)}async reload(){this.reset(),await this.initialize()}reset(){this.config.autoRenewEnabled&&clearInterval(this.renewalIntervalPointer),this.checkUpcomingEntitlementChangesCron&&clearInterval(this.checkUpcomingEntitlementChangesCron),this.entitlementChangeTimeoutPointer&&clearTimeout(this.entitlementChangeTimeoutPointer),this.licenseCert=void 0,this.deviceFingerprint=void 0,this.isInitializationCompleted=!1}async computeDeviceFingerprint(){return this.config.deviceFingerprint&&typeof this.config.deviceFingerprint=="function"?await this.config.deviceFingerprint():await N()}async activate(e){if(!this.isInitialized())throw new Error("activation failed because SDK was not yet initialized");if(this.isShuttingDown)throw new Error("activation failed because SDK is shutting down");if(this.config.offlineMode)throw new Error("activation failed because SDK is in offline mode");let t={reservationId:e,tenantId:this.config.tenantId,productIdentifier:this.config.productIdentifier,deviceFingerprint:this.deviceFingerprint};this.hasCert()&&(t.consumerId=this.licenseCert.consumerId,t.renewalToken=this.licenseCert.renewalToken);let n;try{n=await g(`${this.config.server}/activate`,t,{timeoutInMs:1e4})}catch(i){throw this.log("license activation failed: "+i.message,"warn"),new Error(i.message)}if(n.status==200){if(!n.data.hasOwnProperty("licenseKey")||!n.data.hasOwnProperty("x509"))throw this.log("unexpected server response","warn"),new Error("unexpected server response");let i=this.stringifyCertContainer({licenseKey:n.data.licenseKey,x509:n.data.x509});await this.config.saveCertStr(i),await this.initCert(),this.log("license successfully activated","info"),(n.data.detachedEntitlementsCount??0>0)&&this.log(`skipped importing ${n.data.detachedEntitlementsCount} floating entitlements which are currently in use elsewhere`,"info")}else{let i=`license activation failed: ${n.data.message??"unknown reason"}`,r=new Error(i);throw n.data.errorId&&(r.errorId=n.data.errorId),this.log(i,"warn"),r}}async renew({detachFloatingEntitlements:e=!1}={}){if(!this.hasCert())throw new Error("renewal failed because current cert is not initialized");if(this.licenseCert.isEphemeral)return;if(this.isTerminated())throw new Error("renewal failed because current cert was terminated");if(this.config.offlineMode)throw new Error("renewal failed because SDK is in offline mode");let t=this.config.collectUsageMetrics?await this.config.collectUsageMetrics():[],n;try{n=await g(`${this.config.server}/renew`,{consumerId:this.licenseCert.consumerId,tenantId:this.config.tenantId,deviceFingerprint:this.deviceFingerprint,productIdentifier:this.config.productIdentifier,renewalToken:this.licenseCert.renewalToken,detachFloatingEntitlements:e,usageMetrics:t},{timeoutInMs:1e4})}catch(r){throw this.log("license renewal failed: "+r.message,"warn"),new Error(r.message)}let i=n.data;if(n.status==200){if(!i.hasOwnProperty("licenseKey")||!i.hasOwnProperty("x509"))throw this.log("license renewal failed: unexpected server response","warn"),new Error("unexpected server response");let r=this.stringifyCertContainer({licenseKey:i.licenseKey,x509:i.x509});await this.config.saveCertStr(r),this.log("license successfully renewed","debug"),(i.detachedEntitlementsCount??0>0)&&this.log(`skipped importing ${i.detachedEntitlementsCount} floating entitlements which are currently in use elsewhere`,"info"),await this.initCert()}else{let r=`license renewal failed: ${i.message??"unknown reason"}`;this.log(r,"warn");let s=new Error(r);throw i.errorId&&(s.errorId=i.errorId,["NOT_FOUND","CONSUMER_TERMINATED"].includes(i.errorId)&&(this.log("license was terminated by the server. Deleting local cert.","warn"),await this.config.saveCertStr(""),await this.initCert())),s}}hasCert(){return!!this.licenseCert}isTerminated(){if(!this.hasCert())throw new Error("Cert is not initialized");let e=new Date;return this.licenseCert.terminatesAt<e}getExpiryDate(){if(!this.hasCert())throw new Error("Cert is not initialized");return this.licenseCert.expiresAt}getTerminationDate(){if(!this.hasCert())throw new Error("Cert is not initialized");return this.licenseCert.terminatesAt}isValid(e=!0){let t=r=>{e&&this.log(r,"debug")};if(!this.hasCert())return t("cert is invalid because it is undefined"),!1;let n=this.licenseCert,i=new Date;return n.expiresAt<i?(t("cert is invalid because it has expired"),!1):n.terminatesAt<i?(t("cert is invalid because it was terminated"),!1):n.createdAt.getTime()-3e5>i.getTime()?(t("cert is invalid because system clock is out of sync"),!1):n.deviceLock&&this.deviceFingerprint!==n.deviceFingerprint?(t("cert is invalid because device fingerprint does not match"),!1):this.config.tenantId!==n.tenantId?(t("cert is invalid because tenant ID does not match"),!1):!0}hasFeatureEnabled(e,t=!0){return!!this.getFeatureValue(e,t)}hasFeatureDefined(e,t=!0){return this.getFeatureValue(e,t)!==void 0}hasQuotaLeft(e,t){let n=this.getFeatureValue(e);if(n===void 0)return!1;if(typeof n!="number")throw new Error(`${e} cannot be used as quota as it is not numeric`);return n===-1?!0:Math.ceil(t)<Math.ceil(n)}getFeatureValue(e,t=!0){if(!this.hasCert()||t&&!this.isValid())return;let n=this.getFeatures();if(!!n.hasOwnProperty(e))return n[e]}updateCurrentFeatures(){if(!this.hasCert())return;let e=new Date;(this.licenseCert.expiresAt<e||this.licenseCert.terminatesAt<e)&&(this.currentFeatures={}),this.currentFeatures=this.licenseCert.entitlements.filter(t=>t.validFrom<=e&&t.validTo>e).sort((t,n)=>t.validFrom.getTime()-n.validFrom.getTime()).reduce((t,n)=>({...t,...n.features,...n.featureOverrides}),{})}getFeatures(){return this.hasCert()?this.currentFeatures??{}:{}}getCurrentEntitlements(){if(!this.hasCert())return[];let e=new Date;return this.licenseCert.entitlements.filter(t=>t.validFrom<=e&&t.validTo>e)}getManagementJwt(){return this.licenseCert?this.licenseCert.managementJwt:""}isRenewalDue(){if(!this.licenseCert||this.licenseCert.isEphemeral)return!1;let e=new Date().getTime(),t=1e3*60*15,n=1e3*60*20,i=this.licenseCert.expiresAt.getTime(),r=this.licenseCert.issuedAt.getTime(),s=this.licenseCert.terminatesAt.getTime(),o=e>i-this.config.autoRenewOffset*1e3&&e<s,c=this.getCurrentEntitlements().find(h=>e>=h.validTo.getTime()-t&&e<=h.validTo.getTime())!==void 0&&r<e-n;return o||c}toString(){var e,t,n,i,r,s,o,c,h,d,f,p,m;return`## CONSUMER CONFIG ##
 tenantId: ${this.config.tenantId??"<n/a>"}
 productIdentifier: ${this.config.productIdentifier??"<n/a>"}
